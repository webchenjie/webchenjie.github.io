(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{612:function(a,e,t){"use strict";t.r(e);var n=t(8),s=Object(n.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",[a._v("è¯´èµ· iframeï¼Œå¤§å®¶éƒ½ä¼šè§‰å¾—å¾ˆå«Œå¼ƒæˆ–è€…å¾ˆä¸æ„¿æ¥è¿‘ï¼ŒåŸå› å¤§æ¦‚éƒ½æ˜¯ï¼šèƒ½è€—é«˜ï¼Œå®‰å…¨é—®é¢˜ï¼Œspider ä¸å–œæ¬¢å®ƒ...ä¹Ÿæœ‰ï¼ˆä¸å°‘ï¼‰åŒå­¦å†…å¿ƒç‹¬ç™½å°±æ˜¯ï¼šä¸ï¼è¿™å¾ˆ low å¾ˆ dirtyï¼Œæˆ‘æ‰ä¸æƒ³ç”¨æƒ¹ï¼ä½†æ˜¯æˆ‘ä»¬å¿…é¡»çš„æ‰¿è®¤ iframe ä¹‹å¼ºå¤§ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½ä¼šï¼ˆä¸å¾—ä¸ï¼‰ä½¿ç”¨å®ƒï¼ŒçœŸçš„ç´ åˆçˆ±åˆæ¨å‘")])]),a._v(" "),t("h2",{attrs:{id:"iframe-åŸºæœ¬æ¦‚å¿µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-åŸºæœ¬æ¦‚å¿µ"}},[a._v("#")]),a._v(" iframe åŸºæœ¬æ¦‚å¿µ")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v('<iframe src="demo.html" height="300" width="500" name="demo" scrolling="auto" sandbox="allow-same-origin"></iframe>\niframeçš„ä¸€äº›åŸºæœ¬å±æ€§:\n  src iframeé¡µé¢åœ°å€ï¼Œæœ‰åŒåŸŸè·¨åŸŸä¹‹åˆ†\n  height iframeé«˜åº¦\n  width iframeå®½åº¦\n  name iframeå‘½åï¼Œå¯é€šè¿‡window.frames[xxx]è¢«è°ƒç”¨\n  scrolling iframeæ»šåŠ¨æ¨¡å¼\n  sandbox html5æ–°ç‰¹æ€§ï¼Œç”¨äºé™åˆ¶iframeçš„åŠŸèƒ½\n')])])]),t("h2",{attrs:{id:"ä½¿ç”¨-iframe-çš„æ­£ç¡®å§¿åŠ¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-iframe-çš„æ­£ç¡®å§¿åŠ¿"}},[a._v("#")]),a._v(" ä½¿ç”¨ iframe çš„æ­£ç¡®å§¿åŠ¿")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. æˆ‘ä»¬å¯ä»¥é€šè¿‡contentWindowå’ŒcontentDocumentä¸¤ä¸ªAPIè·å–iframeçš„windowå¯¹è±¡å’Œdocumentå¯¹è±¡ã€‚\n  let iframe = document.getElementById('demo');\n  let iwindow = iframe.contentWindow; // è·å–iframeçš„windowå¯¹è±¡\n  let idoc = iframe.contentDocument; // è·å–iframeçš„documentå¯¹è±¡\n2. åˆšåˆšæˆ‘ä»¬æåˆ°äº†iframeçš„nameå±æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡window.frames[iframeName]æ¥è°ƒç”¨iframeã€‚\n  let iframe = window.frames['demo']\n")])])]),t("h2",{attrs:{id:"iframe-ä½¿ç”¨çˆ¶çº§å†…å®¹çš„æ­£ç¡®å§¿åŠ¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-ä½¿ç”¨çˆ¶çº§å†…å®¹çš„æ­£ç¡®å§¿åŠ¿"}},[a._v("#")]),a._v(" iframe ä½¿ç”¨çˆ¶çº§å†…å®¹çš„æ­£ç¡®å§¿åŠ¿")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("æˆ‘ä»¬é€šè¿‡window.selfï¼Œwindow.parentï¼Œwindow.topè¿™ä¸‰ä¸ªå±æ€§åˆ†åˆ«è·å–è‡ªèº«windowå¯¹è±¡ï¼Œçˆ¶çº§windowå¯¹è±¡ï¼Œé¡¶çº§windowå¯¹è±¡\n")])])]),t("h2",{attrs:{id:"iframe-è·¨åŸŸé€šè®¯ä¹‹-document-domain"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-è·¨åŸŸé€šè®¯ä¹‹-document-domain"}},[a._v("#")]),a._v(" iframe è·¨åŸŸé€šè®¯ä¹‹ document.domain")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. å¯¹äºä¸»åŸŸç›¸åŒå­åŸŸä¸åŒçš„ä¸¤ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡document.domain + iframeæ¥è§£å†³è·¨åŸŸé€šä¿¡é—®é¢˜ã€‚\n2. ä¸¾ä¸ªğŸŒ°ï¼Œç½‘é¡µa(http://www.easonwong.com)å’Œç½‘é¡µb(http://script.easonwong.com)ï¼Œä¸¤è€…éƒ½è®¾ç½®document.domain = 'easonwong.com'ï¼ˆè¿™æ ·æµè§ˆå™¨å°±ä¼šè®¤ä¸ºå®ƒä»¬å¤„äºåŒä¸€ä¸ªåŸŸä¸‹ï¼‰ï¼Œç„¶åç½‘é¡µaå†åˆ›å»ºiframeä¸Šç½‘é¡µbï¼Œå°±å¯ä»¥è¿›è¡Œé€šä¿¡å•¦ï½ï¼\n")])])]),t("h3",{attrs:{id:"ç½‘é¡µ-a"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘é¡µ-a"}},[a._v("#")]),a._v(" ç½‘é¡µ a")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("document.domain = 'easonwong.com';\nvar ifr = document.createElement('iframe');\nifr.src = 'http://script.easonwong.com';\nifr.style.display = 'none';\ndocument.body.appendChild(ifr);\nifr.onload = function(){\n  let doc = ifr.contentDocument || ifr.contentWindow.document;\n  // åœ¨è¿™é‡Œæ“çºµb.html\n};\n")])])]),t("h3",{attrs:{id:"ç½‘é¡µ-b"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘é¡µ-b"}},[a._v("#")]),a._v(" ç½‘é¡µ b")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("document.domain = 'easonwong.com';\n")])])]),t("h2",{attrs:{id:"iframe-è·¨åŸŸé€šè®¯ä¹‹-postmessage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-è·¨åŸŸé€šè®¯ä¹‹-postmessage"}},[a._v("#")]),a._v(" iframe è·¨åŸŸé€šè®¯ä¹‹ postMessage")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("æˆ‘ä»¬å¯ä»¥é€šè¿‡html5è¿™ä¸ªæ–°ç‰¹æ€§è¿›è¡Œiframeé—´çš„è·¨åŸŸé€šä¿¡ï¼Œä½¿ç”¨postMessageè¿›è¡Œæ•°æ®ä¼ é€’ï¼Œé€šè¿‡Messageç›‘å¬é€šä¿¡äº‹ä»¶ã€‚ä¸¾ä¸ªğŸŒ°\n")])])]),t("h3",{attrs:{id:"ç½‘é¡µ-a-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘é¡µ-a-2"}},[a._v("#")]),a._v(" ç½‘é¡µ a")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("document.domain = 'easonwong.com';\nvar ifr = document.createElement('iframe');\nifr.src = 'http://script.easonwong.com';\nifr.style.display = 'none';\ndocument.body.appendChild(ifr);\n// å‘é€æ•°æ®\nifr.postmessage('hello, I`m a', 'http://script.easonwong.com');\n")])])]),t("h3",{attrs:{id:"ç½‘é¡µ-b-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘é¡µ-b-2"}},[a._v("#")]),a._v(" ç½‘é¡µ b")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("// ç›‘å¬messageäº‹ä»¶\nwindow.addEventListener('message', receiver, false);\nfunction receiver(e) {\n    if (e.origin == 'http://www.easonwong.com') {\n        if (e.data == 'hello, I`m a') {\n            e.source.postMessage('hello, I`m b', e.origin);ä¿¡æ¯\n        }\n    }\n}\n")])])]),t("h2",{attrs:{id:"iframe-çš„å…¶ä»–ç”¨é€”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-çš„å…¶ä»–ç”¨é€”"}},[a._v("#")]),a._v(" iframe çš„å…¶ä»–ç”¨é€”")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. ç”¨iframeè¿›è¡Œå¼‚æ­¥è¯·æ±‚\n    åœ¨å¾ˆä¹…å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œä¹…åˆ°ajaxè¿˜æ²¡å‡ºç°çš„æ—¶å€™ï¼Œäººä»¬ä¼šç”¨iframeæ¥è¿›è¡Œå¼‚æ­¥è¯·æ±‚ã€‚\n    å¤§æ¦‚å°±æ˜¯å¼‚æ­¥åˆ›å»ºiframeï¼Œç„¶ååå°è¿”å›æ•°æ®åœ¨iframeä¸­ï¼Œæˆ‘ä»¬åœ¨ä»é‡Œé¢è·å–æ•°æ®ã€‚\n    ä¾‹å¦‚åœ¨æˆ‘åšè¿‡çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œé€šè¿‡iframe.srcä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½åœ°å€ï¼Œå®ç°æ— éœ€æ‰“å¼€æ–°çª—å£ä¸‹è½½æ–‡ä»¶ã€‚\n2. å¼•ç”¨/å±•ç¤ºç¬¬ä¸‰æ–¹å†…å®¹\n3. éœ€è¦ç‹¬ç«‹æ ·å¼å’Œå¸¦æœ‰äº¤äº’çš„å†…å®¹ï¼Œä¾‹å¦‚å¹»ç¯ç‰‡\n4. sandboxæ²™ç®±éš”ç¦»\n5. å†å²è®°å½•ç®¡ç†\n")])])]),t("h2",{attrs:{id:"iframe-çš„å®‰å…¨é—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-çš„å®‰å…¨é—®é¢˜"}},[a._v("#")]),a._v(" iframe çš„å®‰å…¨é—®é¢˜")]),a._v(" "),t("h3",{attrs:{id:"iframe-å°å¹¿å‘Š"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe-å°å¹¿å‘Š"}},[a._v("#")]),a._v(" iframe å°å¹¿å‘Š")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. å¾ˆè®©æˆ‘ä»¬è®¨åŒiframeçš„ä¸€ç‚¹ï¼Œå°±æ˜¯å¾ˆå¤š*ç½‘ç«™éƒ½ä¼šæœ‰å„ç§è®©äººé˜²ä¸èƒœé˜²çš„å°å¹¿å‘Šï¼Œå®ƒä»¬å¤§å¤šå°±æ˜¯ç”¨é€šè¿‡iframeå®ç°çš„\n   æœ¬æ¥æƒ³ç‚¹å‡»æŸä¸ªæ’­æ”¾æŒ‰é’®ï¼Œç»“æœé©¬é¸­ç›´æ¥è·³å‡ åè·³ä¸çŸ¥é“å»äº†å“ªä¸ªæ–°ä¸–ç•Œå»äº†ã€‚\n2. æ›´è®¨åŒçš„ä¸€ç§æƒ…å†µæ˜¯ï¼Œå¯èƒ½ä¸çŸ¥é“å“ªå¤©ç”¨æˆ·çªç„¶æ‹¿åˆ€è¿‡æ¥ï¼Œè¯´æˆ‘ä»¬çš„é¡¹ç›®é¡µé¢é‡Œå‡ºç°äº†é‡é¸¡å¹¿å‘Šï¼Œè¯´æˆ‘ä»¬åœ¨æ¶ˆè´¹ä»–ä»¬\n   ä¸€è„¸æ‡µé€¼çš„æˆ‘ä»¬è§‰å¾—ååˆ†æ— è¾œã€‚å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬çš„é¡µé¢è¢«è¿è¡Œå•†åŠ«æŒäº†ï¼Œè¢«æŒ‚ä¸Šäº†æ³¨å…¥äº†ä¸çŸ¥åçš„é‡é¸¡å¹¿å‘Šã€‚\n3. æ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦æ³¨æ„åœ¨ç”¨iframeçš„åŒæ—¶ï¼Œè¦é˜²æ­¢æˆ‘ä»¬è¢«iframeäº†ã€‚\n")])])]),t("h3",{attrs:{id:"é˜²åµŒå¥—é¡µé¢æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é˜²åµŒå¥—é¡µé¢æ“ä½œ"}},[a._v("#")]),a._v(" é˜²åµŒå¥—é¡µé¢æ“ä½œ")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. åœ¨å‰ç«¯é¢†åŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡window.topæ¥é˜²æ­¢æˆ‘ä»¬é¡µé¢è¢«åµŒå¥—ã€‚\n  if(window != window.top){\n    window.top.location.href = myURL;\n  }\n\n2. æˆ–è€…é€šè¿‡window.location.hostæ¥æ£€æµ‹æ˜¯å¦è·¨åŸŸäº†\n  if (top.location.host != window.location.host) {\nã€€ã€€top.location.href = window.location.href;\n  }\n3. è€Œåç«¯ä¹Ÿå¯ä»¥åšå¯¹åº”çš„é˜²èŒƒæªæ–½ï¼Œé€šè¿‡è®¾ç½®X-Frame-Optionså“åº”å¤´æ¥ç¡®ä¿è‡ªå·±ç½‘ç«™çš„å†…å®¹æ²¡æœ‰è¢«åµŒåˆ°åˆ«äººçš„ç½‘ç«™ä¸­å»\n   ä¹Ÿä»è€Œé¿å…äº†ç‚¹å‡»åŠ«æŒ (clickjacking) çš„æ”»å‡»ã€‚\n")])])]),t("h3",{attrs:{id:"csp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#csp"}},[a._v("#")]),a._v(" CSP")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1. å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰ç”¨äºæ£€æµ‹å’Œå‡è½»ç”¨äº Web ç«™ç‚¹çš„ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼Œä¾‹å¦‚ XSS å’Œæ•°æ®æ³¨å…¥ç­‰ã€‚\n\n2. é€šè¿‡CSPé…ç½®sandboxå’Œchild-srcå¯ä»¥è®¾ç½®iframeçš„æœ‰æ•ˆåœ°å€ï¼Œå®ƒé™åˆ¶é€‚iframeçš„è¡Œä¸ºï¼ŒåŒ…æ‹¬é˜»æ­¢å¼¹å‡ºçª—å£\n   é˜²æ­¢æ’ä»¶å’Œè„šæœ¬çš„æ‰§è¡Œ,è€Œä¸”å¯ä»¥æ‰§è¡Œä¸€ä¸ªåŒæºç­–ç•¥ã€‚\n\n3. æˆ‘ä»¬å¯ä»¥åœ¨htmlå¤´éƒ¨ä¸­åŠ ä¸Š<meta>æ ‡ç­¾\n  <meta http-equiv=\"Content-Security-Policy\" content=\"child-src 'unsafe-inline' 'unsafe-eval' www.easonwong.com\">\n\n3. æˆ–è€…é€šè¿‡HTTPå¤´éƒ¨ä¿¡æ¯åŠ ä¸ŠContent-Security-Policyå­—æ®µ\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",[a._v("ä½œè€…ï¼šRocky_Wong "),t("br"),a._v("\né“¾æ¥ï¼šhttps://www.jianshu.com/p/7ec986aa28a7 "),t("br"),a._v("\næ¥æºï¼šç®€ä¹¦")])])])}),[],!1,null,null,null);e.default=s.exports}}]);